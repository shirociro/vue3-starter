import{aj as z,A as k,B as L,g as l,R as T,a8 as h,ae as p,a9 as U,c as u,o as c,a,U as m,W as A,_ as E,k as B,t as R,x as S,p as C,r as M,C as D,s as w,b as v,T as X,D as Y,F as I,E as P}from"./index-C-Wx4nDS.js";import{b as K,s as H,u as q,a as j,g as W,_ as N,c as V,E as O}from"./Loading-D7qaePDp.js";const x=z("stacks",{state:()=>({page:1,limit:8,search:"",types:"all",sortedBy:"createdAt",glowingEffectIDs:[],fadingEffectIDs:[]}),persist:{paths:["page","limit","search","types","sortedBy"]},actions:{setPage(t){this.page=t},setSearch(t){this.search=t},setTypes(t){this.types=t},setLimit(t){this.limit=t},setSortedBy(t){this.sortedBy=t},glowEffect(t){this.glowingEffectIDs.includes(t)||(this.glowingEffectIDs.push(t),setTimeout(()=>{this.glowingEffectIDs=this.glowingEffectIDs.filter(e=>e!==t)},2500))},fadeEffect(t){this.fadingEffectIDs.includes(t)||(this.fadingEffectIDs.push(t),setTimeout(()=>{this.fadingEffectIDs=this.fadingEffectIDs.filter(e=>e!==t)},2500))}}});function _(t){return L.post("/stacks",t)}function Q(t,e){return L.patch(`/stacks/${t}`,e)}function G(t){return k.delete(`/stacks/${t}`)}function J(t,e,n,o){const r=new URLSearchParams;return r.append("page",String(t)),r.append("limit",String(e)),console.log(n),n&&r.append("search",n),o!=="all"&&r.append("type",String(o)),k.get(`/stacks?${r.toString()}`)}async function Z(t,e,n,o){try{const{data:r}=await J(t,e,n,o);return console.log("Fetched stacks data:",r),r}catch(r){throw console.error("Failed to fetch stacks:",r),r}}async function xe(t){const e=new Date().toISOString(),n=new FormData;n.append("language",t.language),n.append("concepts",t.concepts),n.append("types",t.type_id),n.append("created_at",e),t.logo instanceof File&&n.append("logo",t.logo);try{const{data:o}=await _(n);return o}catch(o){throw console.error(" Failed to add stack:",o),o}}async function $e(t){new Date().toISOString();const e=new FormData;if(e.append("language",t.language),e.append("concepts",t.concepts),e.append("types",t.type_id),e.append("logo",t.logo),e.append("remove_logo",t.remove_logo),!t.id)throw new Error("Logo ID required to update.");try{const{data:n}=await Q(t.id,e);return n}catch(n){throw console.error(" Failed to save logo:",n),n}}async function Fe(t){try{await G(t)}catch(e){throw console.error(" Failed to delete stack:",e),e}}function ee(t,e,n,o){return K({queryKey:["stacks",t,e,n,o],queryFn:()=>Z(l(t),l(e),l(n),l(o)),keepPreviousData:!0})}var te=`
    .p-scrollpanel-content-container {
        overflow: hidden;
        width: 100%;
        height: 100%;
        position: relative;
        z-index: 1;
        float: left;
    }

    .p-scrollpanel-content {
        height: calc(100% + calc(2 * dt('scrollpanel.bar.size')));
        width: calc(100% + calc(2 * dt('scrollpanel.bar.size')));
        padding-inline: 0 calc(2 * dt('scrollpanel.bar.size'));
        padding-block: 0 calc(2 * dt('scrollpanel.bar.size'));
        position: relative;
        overflow: auto;
        box-sizing: border-box;
        scrollbar-width: none;
    }

    .p-scrollpanel-content::-webkit-scrollbar {
        display: none;
    }

    .p-scrollpanel-bar {
        position: relative;
        border-radius: dt('scrollpanel.bar.border.radius');
        z-index: 2;
        cursor: pointer;
        opacity: 0;
        outline-color: transparent;
        background: dt('scrollpanel.bar.background');
        border: 0 none;
        transition:
            outline-color dt('scrollpanel.transition.duration'),
            opacity dt('scrollpanel.transition.duration');
    }

    .p-scrollpanel-bar:focus-visible {
        box-shadow: dt('scrollpanel.bar.focus.ring.shadow');
        outline: dt('scrollpanel.barfocus.ring.width') dt('scrollpanel.bar.focus.ring.style') dt('scrollpanel.bar.focus.ring.color');
        outline-offset: dt('scrollpanel.barfocus.ring.offset');
    }

    .p-scrollpanel-bar-y {
        width: dt('scrollpanel.bar.size');
        inset-block-start: 0;
    }

    .p-scrollpanel-bar-x {
        height: dt('scrollpanel.bar.size');
        inset-block-end: 0;
    }

    .p-scrollpanel-hidden {
        visibility: hidden;
    }

    .p-scrollpanel:hover .p-scrollpanel-bar,
    .p-scrollpanel:active .p-scrollpanel-bar {
        opacity: 1;
    }

    .p-scrollpanel-grabbed {
        user-select: none;
    }
`,ne={root:"p-scrollpanel p-component",contentContainer:"p-scrollpanel-content-container",content:"p-scrollpanel-content",barX:"p-scrollpanel-bar p-scrollpanel-bar-x",barY:"p-scrollpanel-bar p-scrollpanel-bar-y"},se=T.extend({name:"scrollpanel",style:te,classes:ne}),oe={name:"BaseScrollPanel",extends:H,props:{step:{type:Number,default:5}},style:se,provide:function(){return{$pcScrollPanel:this,$parentInstance:this}}},$={name:"ScrollPanel",extends:oe,inheritAttrs:!1,initialized:!1,documentResizeListener:null,documentMouseMoveListener:null,documentMouseUpListener:null,frame:null,scrollXRatio:null,scrollYRatio:null,isXBarClicked:!1,isYBarClicked:!1,lastPageX:null,lastPageY:null,timer:null,outsideClickListener:null,data:function(){return{orientation:"vertical",lastScrollTop:0,lastScrollLeft:0}},mounted:function(){this.$el.offsetParent&&this.initialize()},updated:function(){!this.initialized&&this.$el.offsetParent&&this.initialize()},beforeUnmount:function(){this.unbindDocumentResizeListener(),this.frame&&window.cancelAnimationFrame(this.frame)},methods:{initialize:function(){this.moveBar(),this.bindDocumentResizeListener(),this.calculateContainerHeight()},calculateContainerHeight:function(){var e=getComputedStyle(this.$el),n=getComputedStyle(this.$refs.xBar),o=U(this.$el)-parseInt(n.height,10);e["max-height"]!=="none"&&o===0&&(this.$refs.content.offsetHeight+parseInt(n.height,10)>parseInt(e["max-height"],10)?this.$el.style.height=e["max-height"]:this.$el.style.height=this.$refs.content.offsetHeight+parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)+parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth)+"px")},moveBar:function(){var e=this;if(this.$refs.content){var n=this.$refs.content.scrollWidth,o=this.$refs.content.clientWidth,r=(this.$el.clientHeight-this.$refs.xBar.clientHeight)*-1;this.scrollXRatio=o/n;var s=this.$refs.content.scrollHeight,i=this.$refs.content.clientHeight,d=(this.$el.clientWidth-this.$refs.yBar.clientWidth)*-1;this.scrollYRatio=i/s;var g=Math.max(this.scrollYRatio*100,10);this.frame=this.requestAnimationFrame(function(){e.$refs.xBar&&(e.scrollXRatio>=1?(e.$refs.xBar.setAttribute("data-p-scrollpanel-hidden","true"),!e.isUnstyled&&p(e.$refs.xBar,"p-scrollpanel-hidden")):(e.$refs.xBar.setAttribute("data-p-scrollpanel-hidden","false"),!e.isUnstyled&&h(e.$refs.xBar,"p-scrollpanel-hidden"),e.$refs.xBar.style.cssText="width:"+Math.max(e.scrollXRatio*100,10)+"%; inset-inline-start:"+Math.abs(e.$refs.content.scrollLeft)/n*100+"%;bottom:"+r+"px;")),e.$refs.yBar&&(e.scrollYRatio>=1?(e.$refs.yBar.setAttribute("data-p-scrollpanel-hidden","true"),!e.isUnstyled&&p(e.$refs.yBar,"p-scrollpanel-hidden")):(e.$refs.yBar.setAttribute("data-p-scrollpanel-hidden","false"),!e.isUnstyled&&h(e.$refs.yBar,"p-scrollpanel-hidden"),e.$refs.yBar.style.cssText="height:"+g+"%; top: calc("+e.$refs.content.scrollTop/(s-i)*(100-g)+"% - "+e.$refs.xBar.clientHeight+"px); inset-inline-end:"+d+"px;"))})}},onYBarMouseDown:function(e){this.isYBarClicked=!0,this.$refs.yBar.focus(),this.lastPageY=e.pageY,this.$refs.yBar.setAttribute("data-p-scrollpanel-grabbed","true"),!this.isUnstyled&&p(this.$refs.yBar,"p-scrollpanel-grabbed"),document.body.setAttribute("data-p-scrollpanel-grabbed","true"),!this.isUnstyled&&p(document.body,"p-scrollpanel-grabbed"),this.bindDocumentMouseListeners(),e.preventDefault()},onXBarMouseDown:function(e){this.isXBarClicked=!0,this.$refs.xBar.focus(),this.lastPageX=e.pageX,this.$refs.yBar.setAttribute("data-p-scrollpanel-grabbed","false"),!this.isUnstyled&&p(this.$refs.xBar,"p-scrollpanel-grabbed"),document.body.setAttribute("data-p-scrollpanel-grabbed","false"),!this.isUnstyled&&p(document.body,"p-scrollpanel-grabbed"),this.bindDocumentMouseListeners(),e.preventDefault()},onScroll:function(e){this.lastScrollLeft!==e.target.scrollLeft?(this.lastScrollLeft=e.target.scrollLeft,this.orientation="horizontal"):this.lastScrollTop!==e.target.scrollTop&&(this.lastScrollTop=e.target.scrollTop,this.orientation="vertical"),this.moveBar()},onKeyDown:function(e){if(this.orientation==="vertical")switch(e.code){case"ArrowDown":{this.setTimer("scrollTop",this.step),e.preventDefault();break}case"ArrowUp":{this.setTimer("scrollTop",this.step*-1),e.preventDefault();break}case"ArrowLeft":case"ArrowRight":{e.preventDefault();break}}else if(this.orientation==="horizontal")switch(e.code){case"ArrowRight":{this.setTimer("scrollLeft",this.step),e.preventDefault();break}case"ArrowLeft":{this.setTimer("scrollLeft",this.step*-1),e.preventDefault();break}case"ArrowDown":case"ArrowUp":{e.preventDefault();break}}},onKeyUp:function(){this.clearTimer()},repeat:function(e,n){this.$refs.content[e]+=n,this.moveBar()},setTimer:function(e,n){var o=this;this.clearTimer(),this.timer=setTimeout(function(){o.repeat(e,n)},40)},clearTimer:function(){this.timer&&clearTimeout(this.timer)},onDocumentMouseMove:function(e){this.isXBarClicked?this.onMouseMoveForXBar(e):this.isYBarClicked?this.onMouseMoveForYBar(e):(this.onMouseMoveForXBar(e),this.onMouseMoveForYBar(e))},onMouseMoveForXBar:function(e){var n=this,o=e.pageX-this.lastPageX;this.lastPageX=e.pageX,this.frame=this.requestAnimationFrame(function(){n.$refs.content.scrollLeft+=o/n.scrollXRatio})},onMouseMoveForYBar:function(e){var n=this,o=e.pageY-this.lastPageY;this.lastPageY=e.pageY,this.frame=this.requestAnimationFrame(function(){n.$refs.content.scrollTop+=o/n.scrollYRatio})},onFocus:function(e){this.$refs.xBar.isSameNode(e.target)?this.orientation="horizontal":this.$refs.yBar.isSameNode(e.target)&&(this.orientation="vertical")},onBlur:function(){this.orientation==="horizontal"&&(this.orientation="vertical")},onDocumentMouseUp:function(){this.$refs.yBar.setAttribute("data-p-scrollpanel-grabbed","false"),!this.isUnstyled&&h(this.$refs.yBar,"p-scrollpanel-grabbed"),this.$refs.xBar.setAttribute("data-p-scrollpanel-grabbed","false"),!this.isUnstyled&&h(this.$refs.xBar,"p-scrollpanel-grabbed"),document.body.setAttribute("data-p-scrollpanel-grabbed","false"),!this.isUnstyled&&h(document.body,"p-scrollpanel-grabbed"),this.unbindDocumentMouseListeners(),this.isXBarClicked=!1,this.isYBarClicked=!1},requestAnimationFrame:function(e){var n=window.requestAnimationFrame||this.timeoutFrame;return n(e)},refresh:function(){this.moveBar()},scrollTop:function(e){var n=this.$refs.content.scrollHeight-this.$refs.content.clientHeight;e=e>n?n:e>0?e:0,this.$refs.content.scrollTop=e},timeoutFrame:function(e){setTimeout(e,0)},bindDocumentMouseListeners:function(){var e=this;this.documentMouseMoveListener||(this.documentMouseMoveListener=function(n){e.onDocumentMouseMove(n)},document.addEventListener("mousemove",this.documentMouseMoveListener)),this.documentMouseUpListener||(this.documentMouseUpListener=function(n){e.onDocumentMouseUp(n)},document.addEventListener("mouseup",this.documentMouseUpListener))},unbindDocumentMouseListeners:function(){this.documentMouseMoveListener&&(document.removeEventListener("mousemove",this.documentMouseMoveListener),this.documentMouseMoveListener=null),this.documentMouseUpListener&&(document.removeEventListener("mouseup",this.documentMouseUpListener),this.documentMouseUpListener=null)},bindDocumentResizeListener:function(){var e=this;this.documentResizeListener||(this.documentResizeListener=function(){e.moveBar()},window.addEventListener("resize",this.documentResizeListener))},unbindDocumentResizeListener:function(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}},computed:{contentId:function(){return this.$id+"_content"}}},re=["id"],ie=["aria-controls","aria-valuenow"],ae=["aria-controls","aria-valuenow"];function le(t,e,n,o,r,s){return c(),u("div",m({class:t.cx("root")},t.ptmi("root")),[a("div",m({class:t.cx("contentContainer")},t.ptm("contentContainer")),[a("div",m({ref:"content",id:s.contentId,class:t.cx("content"),onScroll:e[0]||(e[0]=function(){return s.onScroll&&s.onScroll.apply(s,arguments)}),onMouseenter:e[1]||(e[1]=function(){return s.moveBar&&s.moveBar.apply(s,arguments)})},t.ptm("content")),[A(t.$slots,"default")],16,re)],16),a("div",m({ref:"xBar",class:t.cx("barx"),tabindex:"0",role:"scrollbar","aria-orientation":"horizontal","aria-controls":s.contentId,"aria-valuenow":r.lastScrollLeft,onMousedown:e[2]||(e[2]=function(){return s.onXBarMouseDown&&s.onXBarMouseDown.apply(s,arguments)}),onKeydown:e[3]||(e[3]=function(i){return s.onKeyDown(i)}),onKeyup:e[4]||(e[4]=function(){return s.onKeyUp&&s.onKeyUp.apply(s,arguments)}),onFocus:e[5]||(e[5]=function(){return s.onFocus&&s.onFocus.apply(s,arguments)}),onBlur:e[6]||(e[6]=function(){return s.onBlur&&s.onBlur.apply(s,arguments)})},t.ptm("barx"),{"data-pc-group-section":"bar"}),null,16,ie),a("div",m({ref:"yBar",class:t.cx("bary"),tabindex:"0",role:"scrollbar","aria-orientation":"vertical","aria-controls":s.contentId,"aria-valuenow":r.lastScrollTop,onMousedown:e[7]||(e[7]=function(){return s.onYBarMouseDown&&s.onYBarMouseDown.apply(s,arguments)}),onKeydown:e[8]||(e[8]=function(i){return s.onKeyDown(i)}),onKeyup:e[9]||(e[9]=function(){return s.onKeyUp&&s.onKeyUp.apply(s,arguments)}),onFocus:e[10]||(e[10]=function(){return s.onFocus&&s.onFocus.apply(s,arguments)})},t.ptm("bary"),{"data-pc-group-section":"bar"}),null,16,ae)],16)}$.render=le;const ce=["data-id"],ue={class:"row g-0"},de={class:"d-flex gap-2 justify-content-end"},fe={class:"col-md-12 justify-content-center d-flex"},pe={class:"mb-2",style:{width:"80px",height:"80px",border:"3px solid #4caf50","border-radius":"50%",padding:"2px"}},he=["src"],me={key:1,class:"bi bi-person d-flex justify-content-center align-items-center text-secondary",style:{"font-size":"4rem",width:"100%",height:"100%"}},ge={class:"col-md-12"},be={key:"normal"},ye={class:"card-title"},ve=["innerHTML"],we={__name:"StackItem",props:{stack:{type:Object,required:!0}},setup(t){const e=x(),n=q();function o(s,i){s.logo==""&&(i.target.style.display="none")}j({mutationFn:s=>(void 0)(s),onMutate:s=>{e.fadeEffect(s)},onSuccess:()=>{setTimeout(()=>{n.invalidateQueries({queryKey:["stacks"]})},1500)},onError:(s,i)=>{console.error(s)}});const r=s=>{deleteUserMutation.mutate(s)};return(s,i)=>(c(),u("div",{class:C(["card p-3 mb-3",l(e).fadingEffectIDs.includes(t.stack.id)?"fade-out glow-danger":l(e).glowingEffectIDs.includes(t.stack.id)?"glow":""]),"data-id":t.stack.id},[a("div",ue,[a("div",de,[a("button",{onClick:i[0]||(i[0]=d=>s.$emit("action",t.stack)),class:"btn btn-sm rounded-circle btn-outline-primary"},[...i[3]||(i[3]=[a("i",{class:"bi bi-pencil"},null,-1)])]),a("button",{onClick:i[1]||(i[1]=d=>r(t.stack.id)),class:"btn btn-sm rounded-circle btn-outline-danger"},[...i[4]||(i[4]=[a("i",{class:"bi bi-trash"},null,-1)])])]),a("div",fe,[a("div",pe,[t.stack.logo?(c(),u("img",{key:0,src:l(W)(t.stack.logo),alt:"Avatar",class:"rounded-circle",style:{width:"100%",height:"100%","object-fit":"cover"},onError:i[2]||(i[2]=d=>o(t.stack,d))},null,40,he)):(c(),u("i",me))])]),a("div",ge,[a("div",be,[a("h5",ye,R(t.stack.language),1),i[5]||(i[5]=a("hr",null,null,-1)),B(l($),{style:{width:"100%",height:"250px"}},{default:S(()=>[a("div",{ref:"textBox",style:{transition:"max-height 0.3s ease"},class:"card-text mt-3",innerHTML:t.stack.concepts},null,8,ve)]),_:1})])])])],10,ce))}},Be=E(we,[["__scopeId","data-v-6c93aaf6"]]),Me={class:"stacks-list-view"},De={key:0,class:"row g-4 align-items-stretch"},ke={__name:"StacksList",setup(t){const e=x(),n=M(e.page),o=M(e.limit),{data:r,isLoading:s}=ee(n,o,D(()=>e.search),D(()=>e.types)),i=Y("openModal");function d(b){i?.("Edit",b)}function g(b){openDeleteModal?.(b)}return(b,y)=>(c(),u("div",Me,[l(s)?(c(),w(V,{key:0})):v("",!0),B(X,{name:"fade-slide",mode:"out-in"},{default:S(()=>[l(r)?.rows?.length&&!l(s)?(c(),u("div",De,[(c(!0),u(I,null,P(l(r)?.rows,f=>(c(),u("div",{key:f.id,class:"col-12 col-sm-6 col-lg-4 stack-card"},[B(Be,{stack:f,mode:"edit",onAction:F=>d(f),onDelete:F=>g(f)},null,8,["stack","onAction","onDelete"])]))),128))])):v("",!0)]),_:1}),!l(s)&&!l(r).rows?.length?(c(),w(O,{key:1})):v("",!0),l(r)?.total>o.value?(c(),w(N,{key:2,modelValue:n.value,"onUpdate:modelValue":[y[0]||(y[0]=f=>n.value=f),y[1]||(y[1]=f=>l(e).setPage(n.value))],totalRows:l(r).total,"per-page":o.value},null,8,["modelValue","totalRows","per-page"])):v("",!0)]))}},ze=Object.freeze(Object.defineProperty({__proto__:null,default:ke},Symbol.toStringTag,{value:"Module"}));export{ze as S,ke as _,$e as a,xe as c,Fe as d,$ as s,x as u};
