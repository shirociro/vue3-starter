import{r as a,c as p,o as v,a as e,d as f,j as P,g as y,v as _,_ as D,k as w,b as Q,l as G,m as N,n as J,t as W,w as X,p as x,q as Y,s as R,x as Z,T as ee,y as te,i as le,z as oe}from"./index-i8-7myEf.js";import{s as se,l as ae,_ as ne}from"./index-DHbkVxAK.js";import{u as E}from"./usersStore-CPJWN_UK.js";import{c as ie,u as re,d as de,_ as ue}from"./UsersList-hatwRmVw.js";import{g as me,u as h,a as K}from"./Loading-CbEcHYbF.js";const ce={class:"d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-3 pb-4 flex-wrap"},ve={class:"d-flex align-items-center gap-2 flex-shrink-0"},fe={class:"d-flex flex-wrap gap-2 justify-content-end align-items-center flex-grow-1"},pe={class:"d-flex align-items-center gap-2 flex-grow-1 flex-md-grow-0 min-w-0"},ge={class:"d-flex align-items-center gap-2 flex-grow-1 flex-md-grow-0 min-w-0"},ye={__name:"UserToolbar",setup(s){const n=E(),i=a(n.search);return a("all"),(l,o)=>(v(),p("div",ce,[e("div",ve,[o[6]||(o[6]=e("h2",{class:"m-0"},"Users",-1)),e("button",{class:"btn btn-primary d-flex justify-content-center align-items-center p-2 rounded-circle",style:{height:"40px",width:"40px"},onClick:o[0]||(o[0]=m=>l.$emit("action","Add")),title:"Add User"},[...o[5]||(o[5]=[e("i",{class:"bi bi-plus-lg fs-4"},null,-1)])])]),e("div",fe,[e("div",pe,[o[8]||(o[8]=e("label",{class:"form-label m-0"},"Position:",-1)),f(e("select",{class:"form-select flex-grow-1","onUpdate:modelValue":o[1]||(o[1]=m=>y(n).position=m),onChange:o[2]||(o[2]=m=>y(n).setPosition(y(n).position))},[...o[7]||(o[7]=[e("option",{value:"all"},"All",-1),e("option",{value:"1"},"Frontend",-1),e("option",{value:"2"},"Backend",-1),e("option",{value:"3"},"QA",-1)])],544),[[P,y(n).position]])]),e("div",ge,[f(e("input",{type:"text","onUpdate:modelValue":o[3]||(o[3]=m=>i.value=m),onInput:o[4]||(o[4]=m=>y(n).setSearch(i.value)),class:"form-control",placeholder:"Search..."},null,544),[[_,i.value]])])])]))}},be={class:"text-center mt-3 mb-3 position-relative",style:{width:"100px",margin:"0 auto"}},xe=["src"],Ue={__name:"ProfileUpload",props:{profile:{type:String,required:!1},mode:{type:String,required:!1}},emits:["update"],setup(s,{emit:n}){const i=a(null),l=a(""),o=n,m=()=>{i.value?.choose()},$=c=>{const u=c.files?.[0];u&&(l.value=URL.createObjectURL(u),o("update",u))},g=c=>{l.value=null,o("update",null)};return(c,u)=>(v(),p("div",be,[w(y(se),{ref_key:"fileUpload",ref:i,mode:"basic",accept:"image/*",customUpload:!0,chooseLabel:"",onSelect:$,class:"d-none"},null,512),l.value||s.profile?(v(),p("img",{key:0,src:s.mode=="Edit"&&!l.value?y(me)(s.profile):l.value,alt:"Profile Avatar",class:"rounded-circle border avatar-img",onClick:m},null,8,xe)):Q("",!0),l.value||s.profile?(v(),p("i",{key:1,onClick:u[0]||(u[0]=F=>g()),class:"bi bi-trash-fill text-danger position-absolute",style:{top:"65%",right:"0px",cursor:"pointer","background-color":"white","border-radius":"30%","font-size":"1.2rem",padding:"4px"}})):(v(),p("div",{key:2,class:"rounded-circle border avatar-img d-flex align-items-center justify-content-center bg-light text-secondary",onClick:m},[...u[1]||(u[1]=[e("i",{class:"bi bi-person",style:{"font-size":"4rem"}},null,-1)])]))]))}},we=D(Ue,[["__scopeId","data-v-f9c562f3"]]);function $e(){const s=h(),n=K({mutationFn:ie,onSuccess:()=>{s.invalidateQueries({queryKey:["users"]})}}),i=K({mutationFn:re,onSuccess:()=>{s.invalidateQueries({queryKey:["users"]})}}),l=K({mutationFn:de,onSuccess:()=>{s.invalidateQueries({queryKey:["users"]})}});return{createUser:n,updateUser:i,deleteUser:l}}const ke={class:"modal-dialog modal-dialog-centered",style:{"max-width":"400px !important"}},Se={class:"modal-content"},Ce={class:"modal-header"},Ae={class:"modal-title"},Ve={class:"modal-body"},_e={class:"row gy-2"},Me={class:"col-12 d-flex align-items-center"},qe={class:"col-12 d-flex align-items-center"},Fe={class:"col-12 d-flex align-items-center"},Ke={key:0,class:"col-12 d-flex align-items-center"},Pe={class:"col-12 d-flex align-items-center"},De={class:"col-12 d-flex align-items-center"},Qe=G({__name:"ModalForm",props:{mode:{},userData:{}},emits:["close"],setup(s,{emit:n}){const i=h(),l=s,o=n,m=E(),{createUser:$,updateUser:g}=$e(),c=a(!1),u=a(""),F=a(!0),k=a(""),j=a(!0),S=a(""),B=a(!0),M=a(""),T=a(!0),C=a(""),z=a(!0),A=a(""),I=a(!0),V=a();function O(){const r={id:l.mode==="Edit"?l.userData.id:void 0,firstname:u.value,lastname:k.value,username:S.value,password:l.mode==="Add"?M.value:void 0,position_id:C.value,role_id:A.value,profile:V.value,remove_profile:c.value};l.mode==="Edit"?g.mutate(r,{onSuccess:t=>{q(),m.glowEffect(r.id),setTimeout(()=>{i.invalidateQueries({queryKey:["users"]})},1500)}}):$.mutate(r,{onSuccess:t=>{q()}})}function b(r,t){r||r.length!=0}function q(){o("close")}N(()=>l.userData,r=>{u.value=r?.firstname||"",k.value=r?.lastname||"",S.value=r?.username||"",C.value=r?.position_id||"",A.value=r?.role_id||"",V.value=r?.profile||""},{immediate:!0});function H(r){r?(V.value=r,c.value=!1):(V.value="",c.value=!0)}return(r,t)=>(v(),p("div",{class:"modal fade show d-block",tabindex:"-1",role:"dialog","aria-modal":"true",style:{"background-color":"rgba(0, 0, 0, 0.5)"},onKeydown:J(q,["esc"])},[e("div",ke,[e("div",Se,[e("div",Ce,[e("h5",Ae,W(s.mode)+" User",1)]),e("div",Ve,[e("form",{onSubmit:X(O,["prevent"])},[w(we,{onUpdate:H,profile:V.value,mode:s.mode},null,8,["profile","mode"]),e("div",_e,[e("div",Me,[t[12]||(t[12]=e("label",{class:"form-label me-2 mb-0"},"Firstname",-1)),f(e("input",{"onUpdate:modelValue":t[0]||(t[0]=d=>u.value=d),maxlength:"100",class:x(["form-control flex-fill",{"is-invalid":!F.value}]),placeholder:"",onKeyup:t[1]||(t[1]=d=>b(u.value,F.value))},null,34),[[_,u.value]])]),e("div",qe,[t[13]||(t[13]=e("label",{class:"form-label me-2 mb-0"},"Lastname",-1)),f(e("input",{"onUpdate:modelValue":t[2]||(t[2]=d=>k.value=d),maxlength:"100",class:x(["form-control flex-fill",{"is-invalid":!j.value}]),placeholder:"",onKeyup:t[3]||(t[3]=d=>b(k.value,j.value))},null,34),[[_,k.value]])]),e("div",Fe,[t[14]||(t[14]=e("label",{class:"form-label me-2 mb-0"},"Username",-1)),f(e("input",{"onUpdate:modelValue":t[4]||(t[4]=d=>S.value=d),maxlength:"100",class:x(["form-control flex-fill",{"is-invalid":!B.value}]),placeholder:"",onKeyup:t[5]||(t[5]=d=>b(S.value,B.value))},null,34),[[_,S.value]])]),s.mode=="Add"?(v(),p("div",Ke,[t[15]||(t[15]=e("label",{class:"form-label me-2 mb-0"},"Password",-1)),f(e("input",{"onUpdate:modelValue":t[6]||(t[6]=d=>M.value=d),type:"password",maxlength:"100",class:x(["form-control flex-fill",{"is-invalid":!T.value}]),placeholder:"",onKeyup:t[7]||(t[7]=d=>b(M.value,T.value))},null,34),[[_,M.value]])])):Q("",!0),e("div",Pe,[t[17]||(t[17]=e("label",{class:"form-label me-2 mb-0"},"Position",-1)),f(e("select",{"onUpdate:modelValue":t[8]||(t[8]=d=>C.value=d),class:x(["form-select flex-fill",{"is-invalid":!z.value}]),onChange:t[9]||(t[9]=d=>b(C.value,z.value))},[...t[16]||(t[16]=[e("option",{value:""},"Select Position",-1),e("option",{value:"1"},"Frontend",-1),e("option",{value:"2"},"Backend",-1),e("option",{value:"3"},"QA",-1)])],34),[[P,C.value]])]),e("div",De,[t[19]||(t[19]=e("label",{class:"form-label me-2 mb-0"},"Role",-1)),f(e("select",{"onUpdate:modelValue":t[10]||(t[10]=d=>A.value=d),class:x(["form-select flex-fill",{"is-invalid":!I.value}]),onChange:t[11]||(t[11]=d=>b(A.value,I.value))},[...t[18]||(t[18]=[e("option",{value:""},"Select Role",-1),e("option",{value:"1"},"Admin",-1),e("option",{value:"2"},"User",-1)])],34),[[P,A.value]])])]),e("div",{class:"modal-footer mt-3"},[e("button",{type:"button",class:"btn btn-secondary",onClick:q}," Cancel "),t[20]||(t[20]=e("button",{type:"submit",class:"btn btn-primary"},"Save",-1))])],32)])])])],32))}}),Ee=D(Qe,[["__scopeId","data-v-73196f73"]]),he=window.location.hostname==="localhost"?"localhost":window.location.hostname;let U=null;function je(){return U||(U=ae(`http://${he}:3000`,{transports:["websocket"],autoConnect:!0}),U.on("connect",()=>{console.log("ðŸŸ¢ User socket connected:",U.id)}),U.on("disconnect",s=>{console.warn("ðŸ”´ User socket disconnected:",s)})),U}let L=!1;function Be(){if(L)return;L=!0;const s=je(),n=E(),i=h();s.on("userCreated",l=>{n.glowUser(l.id),i.invalidateQueries({queryKey:["users"]})}),s.on("userUpdated",l=>{n.glowUser(l.id),i.invalidateQueries({queryKey:["users"]})}),s.on("userDeleted",l=>{n.fadeOutUser(l.id),i.invalidateQueries({queryKey:["users"]})})}const Te={class:"users-layout d-flex"},ze={class:"flex-grow-1 d-flex flex-column"},Ie={class:"p-4 flex-grow-1"},Re={__name:"UsersPage",setup(s){const n=a(null),i=a("Add"),l=a(!1);function o(g="Add",c={}){i.value=g==="Edit"?"Edit":"Add",n.value=g==="Edit"?c:{},l.value=!0}function m(){l.value=!1,n.value=null}oe("openModal",o);const $=le();return N(()=>$.fullPath,()=>{m()}),Y(()=>{Be()}),(g,c)=>(v(),p("div",Te,[e("div",ze,[w(ne),e("main",Ie,[w(ye,{onAction:c[0]||(c[0]=u=>o())}),w(ue)])]),(v(),R(te,{to:"body"},[w(ee,{name:"fade",mode:"out-in"},{default:Z(()=>[l.value?(v(),R(Ee,{key:0,userData:n.value,mode:i.value,onClose:m},null,8,["userData","mode"])):Q("",!0)]),_:1})]))]))}},Je=D(Re,[["__scopeId","data-v-08aaf623"]]);export{Je as default};
